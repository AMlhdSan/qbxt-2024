# #3. 小平方葱

## 题目背景

你是能看到第三题的friends呢。

——laekov

## 题目描述

在一个奇妙的数学王国里，住着一个活泼而机智的小家伙——小葱。小葱不仅是厨房中不可或缺的角色，也是数学王国的好奇心探险者。最近，小葱对数学中的“平方”产生了浓厚的兴趣，总想探个究竟。

某天，小葱决定踏上探索平方的旅程。他找到王国的智者——老数学家“平方”，询问关于平方的奥秘。

“小葱，”平方微笑着说，“平方是指将一个数与它自身相乘，结果有着令人惊叹的特性。”

为了让小葱更理解，平方给出了一些例子：“举个例子，数字3的平方是9，因为 $3 \times 3 = 9$。而这些平方数常常会在图形、面积计算以及许多数学问题中出现。”

小葱听得入迷，眼睛闪烁着兴奋的光芒。他意识到，平方不仅仅是一个运算符号，更是改变数字世界视角的方法。

在探索途中，小葱遇到了各种有“平方”特性的奇妙景象。比如，他走进一个神奇的花园，发现所有花瓣的数量都是某个数的平方。动植物也优雅地排列成平方形状，让整个景观显得格外和谐美丽。

小葱还结识了其他数字精灵，比如立方精灵、平方根精灵，他们各自都是数学王国中不可或缺的一部分。他们告诉小葱，他们一起构建了一个和谐的数学世界。

通过这一系列探索，小葱不仅知道平方计算的重要性，还意识到数学的奇妙与无限可能。小葱高兴地向平方道谢，并返回厨房，准备与小伙伴们分享这段奇妙旅程中的收获。

此后，小葱在厨房中施展其学到的“平方”技艺，为各种菜肴增添了一丝数学的魔力。而数学王国也因小葱的技艺，给小葱出了一道难题。现在数学王国有$N$个数$a_1,a_2,\cdots,a_N$，同时数学王国给了$M$次操作。如果是操作类型2，则是给定$l,r$，询问$\sum_{i=l}^ra_i$的值。但如果是操作类型$1$，则是给定$l,r$，数学王国需要小葱把这段区间里面的每个数变为这个数各位数字的$k$次方之和。例如如果$k=2$，那么$23$会变成$2^2+3^2=13$。现在小葱人麻了，你需要帮他实现这些操作。

## 输入格式

第一行三个整数$N,M,k$。

第二行$N$个整数代表$a_1,a_2,\cdots,a_N$。

接下来$M$行每行三个整数代表$opt,l,r$，其中$opt$是操作的类型。

## 输出格式

对于每次询问，输出一行一个答案对$10^9+7$取模的结果。

## 样例 #1

### 样例输入 #1

```
5 5 2
1 2 3 4 5
2 1 5
1 1 5
2 1 5
1 1 5
2 1 5
```

### 样例输出 #1

```
15
55
164
```

## 提示

对于$40\%$的数据，$N,M\leq 10^3$。

对于另外$20\%$的数据，$l=1,r=N$。

对于$10\%$的数据，$k=1$。

对于$20\%$的数据，$k=2$。

对于$30\%$的数据，$k=3$。

对于$40\%$的数据，$k=4$。

对于$100\%$的数据，$1\leq N,M\leq 10^5,1\leq k\leq 4,1\leq l\leq r\leq N,1\leq a_i\leq 10^9$。