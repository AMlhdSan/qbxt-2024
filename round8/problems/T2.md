# #2. 树上选点

## 题目描述

在做了 [[NOI2022] 众数](https://www.luogu.com.cn/problem/P8496) 之后，小 H 开始对研究元素的出现次数感兴趣了。

他打算在树上选一些点，研究它们的出现次数。

具体地，有一个 $n$ 个点的有根树，以 $1$ 为根，每个点有一个点权 $a_i$。

定义 $j$ 属于 $i$ 的子树，当且仅当 $i$ 在 $1$ 到 $j$ 的简单路径上。令 $\operatorname{subtree(i)}$ 表示 $i$ 的子树。

小 H 会选出一些点，将它们标为红色

定义 $s(i)$ 为 $i$ 子树内所有红色结点的点权构成的**可重集**，即 $\{a_j |j \in \operatorname{subtree}(i) \land \text{j is red}\}$

定义一个红色结点是好的，当且仅当 $a_i$ 在 $s(i)$ 中出现了至少 $k$ 次。

现在小 H 想知道，有多少种选点方案，使得整棵树的好点个数在 $[L,R]$ 中。

答案对 $10^9+7$ 取模。

## 输入格式

第一行四个整数 $n,L,R,k$，含义见题目描述。

第二行 $n$ 个整数 $a_1,a_2,\dots,a_n$。

第三行 $n - 1$ 个整数 $p_2,p_3,\dots,p_{n}$，$p_i$ 表示 $i$ 号点的父亲。

## 输出格式

一行一个整数，表示答案。

## 样例 #1

### 样例输入 #1

```
4 1 2 2
1 1 1 1
1 2 1
```

### 样例输出 #1

```
9
```

## 提示

在样例 1 中，一种合法的情况是将 $2,3,4$ 号结点标为红色，其中 $2$ 的子树中共有 $2$ 个红点（$2,3$ 号结点）和它点权相同，可以算作好点。$1$ 的子树中虽然有 $3$ 个红色结点和它点权相同，但是由于 $1$ 本身没有被标红，所以不能算作好点。综上，好点数量为 $1$，满足条件。

对于 $20\%$ 的数据，有 $1 \le n \le 20$。

对于另外 $20\%$ 的数据，有 $1 \le n \le 100$。

对于另外 $10\%$ 的数据，有 $1 \le n \le 500$。

对于另外 $10\%$ 的数据，有 $p_i = i - 1$。

对于另外 $20\%$ 的数据，有 $a_i \le 5$。

对于 $100\%$ 的数据，有 $1 \le n \le 3000,1 \le a_i \le n,1 \le L \le R \le n,1 \le k \le n,1 \le p_i \lt i$。
