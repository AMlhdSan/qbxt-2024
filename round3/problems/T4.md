# #4. 里

## 题目描述

给定一个 $n$ 个点 $n$ 条边构成的图，其中边 $i$ 连接点 $i$ 和点 $a_i$ 。我们称点 $i$ 周围的点为与点 $i$ 在图上最短距离 $\leq 1$ 的点，注意点 $i$ 自身是点 $i$ 周围的点。点 $i$ 有 $b_i$ 的权值。

定义点 $i$ 的权值 $c_i$ 为，依次处理每一个点 $x$ ，设 $d$ 表示点 $x$ 周围的点的数量，此时点 $x$ 将其所有周围的点 $y (y \not = x)$ 的权值 $c_y$ 增加 $\lfloor \frac{b_x}{d} \rfloor$ ，并将点 $x$ 的权值 $c_x$ 增加 $b_x - (d-1) \lfloor \frac{b_x}{d} \rfloor$ ，对所有点 $x$ 处理完后得到所有点的权值 $c$ 序列。

有 $m$ 次操作，每次操作有三种类型：

1. 给定 $x$ 和 $y$ ，此时将原先的边 $x$ 删除，并将 $a_x$ 修改为 $y$ ，再将当前的边 $x$ 加入。
2. 给定 $x$ ，询问当前图中点 $x$ 的权值 $c_x$ 。
3. 查询当前图中所有点权值 $c$ 的最小值和最大值。

时间限制 2 秒，空间限制 512 MB。

## 输入格式

第一行两个整数 $n,m$ 。

第二行 $n$ 个整数，第 $i$ 个整数表示 $a_i$ 。

第三行 $n$ 个整数，第 $i$ 个整数表示 $b_i$ 。

接下来 $m$ 行每行一到三个整数，第一个整数为 $op$ ，表示操作类型，接下来输入的整数表示操作参数。

## 输出格式

对于每次类型二和类型三的操作，输出一行表示答案。

## 样例 #1

### 样例输入 #1

```
5 10
3 5 5 3 4 
8 2 2 3 5 
3
1 1 4
2 1
1 1 3
2 1
1 2 3
2 2
1 1 3
2 1
3
```

### 样例输出 #1

```
2 8
4
4
1
4
1 9
```

## 样例 #2

### 样例输入 #2

```
10 20
5 7 7 5 7 5 4 4 7 5 
61 905 409 562 878 600 57 500 732 66 
3
1 1 5
2 1
1 2 5
2 2
1 3 7
2 3
1 3 4
2 3
1 4 5
2 4
1 4 5
2 4
1 2 4
2 2
1 1 7
2 1
1 1 7
2 1
3
```

### 样例输出 #2

```
177 1320
177
578
216
317
707
707
546
42
42
42 1189
```

## 提示

本题开启子任务评测。

子任务 1（10 分）：保证 $n \leq 1000$ 。

子任务 2（20 分）：保证没有操作一。

子任务 3（20 分）：保证没有操作二。

子任务 4（20 分）：保证没有操作三。

子任务 5（30 分）：无特殊限制。

对于所有数据，保证 $3 \leq n \leq 10^5 , 1 \leq m \leq 2 \times 10^5$ ，保证任意时刻给定的图不存在自环和二元环。