# #3. 万

## 题目描述

给定一个长度为 $n$ 的排列 $p$ ，我们知道通过若干次对相邻两项进行交换，可以将排列 $p$ 进行从小往大的排序。

接下来，询问对于给定的排列 $p$ ，有多少种操作顺序可以使得每个相邻两个位置之间恰好交换一次。更准确的说，询问有多少个长度为 $n-1$ 的排列 $a$ 满足，从前往后依次交换 $p_{a_i}$ 和 $p_{a_i+1}$ ，使得可以将原排列 $p$ 升序排序。

进一步的，给定一个长度为 $n$ 的序列 $q$ ，保证 $q$ 中非零元素两两不同，询问所有满足长度为 $n$ 的、且满足若 $q_i \not = 0$ 则有 $p_i = q_i$ 的排列 $p$ 的合法操作顺序数量之和。

时间限制 1 秒，空间限制 1024MB。

## 输入格式

输入的第一行包含一个正整数 $n$ 。

输入的第二行包含 $n$ 个非负整数，第 $i$ 个元素为 $q_i$ 。

## 输出格式

输出一行包含一个整数，表示所有排列的合法操作数量之和 $\bmod \ 998244353$ 的结果。

## 样例 #1

### 样例输入 #1

```
5
0 0 2 0 0
```

### 样例输出 #1

```
4
```

## 样例 #2

### 样例输入 #2

```
5
4 0 0 0 3
```

### 样例输出 #2

```
3
```

## 提示

对于全部数据，保证 $2 \leq n \leq 5000$ ，$0 \leq q_i \leq n$ 。

| 测试点编号 | $n \leq$   | 特殊性质 |
| ------------ | ---- | ---------- |
| $1 \sim 4$           | $10$   |          |
| $5 \sim 6$           | $20$   |          |
| $7 \sim 8$           | $50$   |          |
| $9 \sim 12$           | $300$   |          |
| $13 \sim 14$           | 无 | A        |
| $15 \sim 16$           | 无 | B        |
| $17 \sim 20$           | $5000$   |          |

特殊性质 A：保证对于所有的 $i$ 均有 $q_i \not = 0$ ；

特殊性质 B：保证对于所有的 $i$ 均有 $q_i = 0$ 。