# #2. 首都

## 题目描述

北京有非常复杂的地铁网络，还有很多共享单车。

北京有 $r$ 条双向道路，$s$ 条地铁线路。

一共有 $n$ 个地点，标号 $1\sim n$。

其中 THU 是 $1$ 号地点。

小 H 可以骑共享单车通过道路。

扫描和锁车总共需要 $x$ 的时间。

第 $i$ 条道路连接第 $a_i$ 和第 $b_i$ 个地点，骑共享单车通过需要 $t_i$ 的时间。

小 H 还可以坐地铁，但是他不能把共享单车骑进地铁里。

每个地点都有一个地铁站（可能有的不通车），按照地点编号 $1\sim n$。

第 $i$ 个地铁站需要 $e_i$ 的时间进站或出站。

在第 $i$ 个地铁站换乘需要 $c_i$ 的时间。

地铁有环线和非环线两种。

每一条地铁线路都有一个起点站。

对于每条环线地铁，今天早上 8:00 的时候有两列列车正好分别从起点站往两个方向驶出。

对于每条非环线地铁，起点站是线路的一个端点，今天早上 8:00 的时候有一列列车正好从起点站驶出。列车到达线路的另一个端点之后会立刻返程，返程途中也会在经过的地铁站停车开门。

每一条线路的发车都是均匀的。今天早上 8:00 时也已经有一些之前发车的列车在线路上。

第 $i$ 条地铁线路的发车间隔是 $T_i$。环线地铁会向两个方向发车。并且没有早班车、末班车的安排，发车是持续不断的。

地铁在站与站之间行驶需要时间。

只有当 小 H  进站/换乘之后所在的地铁站有一列地铁到站停车开门时，小 H  才能上车。

小 H  可以等待地铁到站。

假设停车开门的时间计算在行驶时间中。

假设 小 H  出站后能立刻找到一辆能用的共享单车。

小 H  想知道，在今天早上 8:00 从 THU 出发到 个地点中的每个地点需要多少时间。

注意最后一次锁车或者出站的时间要算在总时间中。

## 输入格式

第一行四个非负整数，$n,r,s,x$。

第二行 $n$ 个正整数，表示 $e_i$。

第三行 $n$ 个正整数，表示 $c_i$。

接下来 $r$ 行，每行三个正整数，表示 $a_i,b_i,t_i$。

接下来 $s$ 行，每行若干个正整数，格式如下：

- 第一个正整数 $k$，表示铁路的段数。

- 接下来 $2k+1$ 个正整数 $v_1,l_1,v_2,l_2,\cdots,v_k,l_k,v_{k+1}$，表示铁路按顺序经过的站点和行驶时间。

  其中 $v_1$ 是起点站，$v_{1\dots k}$ 两两不相同，$v_{2\dots k+1}$两两不相同。如果 $v_{k+1}=v_1$ 则说明该线路是环线，否则该线路是非环线。地铁在到达 $v_i$ 和到达 $v_{i+1}$ 之间需要经过 $l_i$ 的时间。

- 最后一个正整数 $T_i$，表示该线路的发车间隔。保证 $T_i|2\sum_{j=1}^kl_j$。如果线路是环线保证 $T_i|\sum_{j=1}^k l_j$。

## 输出格式

一行，$n$ 个非负整数，其中第 $i$ 个表示 chj2001 从 THU 到 $i$ 号地点的最短时间。特别地，第一个数总是 $0$。

## 样例 #1

### 样例输入 #1

```
4 0 1 1
6 6 6 6
2 2 2 2
3 4 3 1 7 2 15 3 10
```

### 样例输出 #1

```
0 26 41 16
```

## 样例 #2

### 样例输入 #2

```
4 5 0 13
1 1 1 1
1 1 1 1
1 3 9
1 2 10
3 4 8
4 2 6
2 3 5
```

### 样例输出 #2

```
0 23 22 29
```

## 样例 #3

### 样例输入 #3

```
13 2 3 8
14 16 16 16 16 16 16 16 16 16 16 16 16
22 32 32 32 32 32 32 32 32 20 32 32 32
3 8 4
11 13 4
6 2 3 3 3 4 3 5 3 6 3 1 3 2 1
3 7 6 8 6 9 6 10 1
2 12 12 10 12 11 1
```

### 样例输出 #3

```
0 33 36 39 36 33 86 48 86 92 124 124 136
```

## 样例 #4

### 样例输入 #4

```
13 2 3 8
14 16 16 16 16 16 16 16 16 16 16 16 16
22 32 32 32 32 32 32 32 32 20 32 32 32
3 8 4
11 13 4
6 2 3 3 3 4 3 5 3 6 3 1 3 2 18
3 7 6 8 6 9 6 10 6
2 12 12 10 12 11 8
```

### 样例输出 #4

```
0 34 37 40 43 40 88 49 88 94 128 128 140
```

## 提示

在样例 1 中，由于 $r=0$ 所以只能坐地铁。在每个点进站或出站都会花费 $6$ 分钟（$e_i$）。

只有一条地铁线路：$4 \to 1 \to 2 \to 3 \to 2 \to 1 \to 4 \to \cdots$，发车间隔为 $10$ 分钟（注意会返程）。

我们在 $1$ 号点花费 $6$ 分钟进站，现在 8:06，然后需要等地铁。
地铁会在 ..., 7:40, 7:50, 8:00, 8:10, 8:20, ... 发车，那么下一辆地铁会在 8:13 到达。

然后沿着铁路坐 $7$ 分钟，在 8:20 到达 $2$ 号地铁站，如果花 $6$ 分钟出站就是在 8:26 到达 $2$ 号点。$3$ 号点是类似的。

$4$ 号点：在 7:20 会发一次车，然后在 7:45 从 3 号地铁站往回开（因为会返程），在 8:07 到达 $1$ 号地铁站，乘坐这辆地铁，会在 8:10 到达 $4$ 号地铁站。

---


本题采用捆绑测试。

保证 $1\leq n\leq 100000$，$0\leq r\leq 300000$，$0\leq s\leq 100000$，$1\leq x\leq 10^9$。

保证 $1\leq e_i,c_i,l_i\leq 10^9$。

保证 $c_i\leq 2e_i$。

保证 $1\leq a_i,b_i\leq n$，$1\leq t_i\leq 10^9$。

保证 $1\leq k\leq n$，$\sum k\leq 2\times 10^5$，$1\leq v_i\leq n$。

保证 $T_i|2\sum_{j=1}^kl_j$。如果线路是环线保证 $T_i|\sum_{j=1}^kl_j$。

保证如果 $v_1=v_{k+1}$ 那么 $k\ge 3$。

保证 小 H 能够到达每个地点。

### 子任务 1（7 pts）

$s=0$，即没有地铁线路。

### 子任务 2（16 pts）

$s\leq 5,x=0,T=1$。

### 子任务 3（19 pts）

$s\leq 5,T=1$。

### 子任务 4（28 pts）

$T_i=1$，即每条地铁线路的发车间隔都是 $1$，这意味着幸运的 小 H 永远不需要等车。

### 子任务 5（15 pts）

$n\leq 1000$。

### 子任务 6（15 pts）

无特殊限制。