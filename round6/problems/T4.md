# #4. The end of 小葱 2024

## 题目背景

你是能看到第四题的friends呢。

——rivenhe

## 题目描述

在这个充满变化与惊喜的时间王国里，小葱是一位观察者，他对时间流逝充满了好奇。在2024年即将结束之际，小葱决定仔细记录这一年的点滴，希望能找到时间流转的深刻意义。

### 年末的回顾

为了回顾2024年的精彩瞬间，小葱启动了他的小型时间旅程机，这机器可以重现过去的亮点。他细细浏览这一年的重要时刻：有高科技的飞速发展，有人类在环境保护上的新突破，还有各国在文化与体育上的交流盛况。

小葱见证了全球团结应对挑战的努力，感受到无数人在追求梦想路上留下的奋斗足迹。他心想：“即使时间飞逝，人们的努力与成长给这个世界带来了很多值得铭记的变化。”

### 节日的庆祝

在2024年的最后一周，小葱被邀请参与一个盛大的节日庆典。城市的街道上灯火辉煌，人们在欢庆中分享着温暖的故事，期许更美好的明年。小葱和大家一起参与倒数计时，共同欢呼：“2025，我们来了！”

庆典上，小葱注意到人们在新年愿望卡上写下的心愿：有人期待健康，有人期盼爱情，还有人希望获得勇气去迎接新的挑战。小葱也悄悄写下自己的愿望，希望永远保持好奇心，持续探索未知。

### 时光的启示

在午夜钟声的伴随下，小葱静静地看着这些众生群像，心中产生了一些领悟。他明白，虽然年华似水而逝，但每个结束都是新的开始，正如2024年与2025年的交接。

“每一年都有其独特的故事和意义，”小葱对自己说，“关键在于如何享受过程，学习如何从每个瞬间中拾起智慧。”

于是，伴随着新年的钟声，小葱意识到：无论时间如何流转，重要的是在每个季节中积极生活、探索和成长。这场跨年的体验让他更加理解了时光的无价和生命的意义。

小葱怀揣着这份新领悟，开始出了一套新的题目。小葱题库里面有总共$N$道题，小葱想拿这$N$道题组$M$套题出来。对于第$i$套题，小葱会给定一个出题密码$p_i$，$p_i$是一个$k_i$进制的数字串，数字串可能包含`?`，代表可以匹配任意数字的一个符号。如果第$j$道题的特征值在$k_i$进制下能够匹配$p_i$，那么第$j$道题就会被编入第$i$套题，同时第$i$套题的题目难度是由这套题所有的题目的难度乘积再加上$z_i$所得到的值的最小质因子大小。很快，小葱就发现，如果想要计算一套题的难度实在过于困难，因此小葱为第$i$套题指定了一个难度上限$x_i$，小葱希望这套题的难度和$x_i$的最小值是多少。

## 输入格式

第一行两个整数$N,M$。

第二行$N$个数代表每道题特征值$a_i$，用十进制表示。

第三行$N$个数代表每道题的难度$d_i$。

接下来$M$行，每行包含$k_i,p_i,x_i,z_i$，代表一套题目的四个参数。

## 输出格式

对于每套题目，一行一个正整数代表答案。

## 样例 #1

### 样例输入 #1

```
4 8
1 2 3 4
2 23 233 2333
2 ? 100 3
3 ? 100 3
4 ? 100 3
5 ? 100 3
2 ?? 100 3
3 ?? 100 3
2 1? 100 2
2 ?0 100 2
```

### 样例输出 #1

```
5
7
71
13
71
13
3
5
```

## 提示

### 样例解释

|套题编号|所选题目特征值|最终难度|
|--|--|--|
|1|1|5|
|2|1,2|49|
|3|1,2,3|10721|
|4|1,2,3,4|25005097|
|5|1,2,3|10721|
|6|1,2,3,4|25005097|
|7|2,3|5361|
|8|2|25|


### 数据范围

对于$40\%$的数据，$N,M\leq 50$。

对于$60\%$的数据，$N,M\leq 1000$。

对于另外$10\%$的数据，$s_i$没有问号。

对于另外$10\%$的数据，$x_i=3$。

对于$100\%$的数据，$1\leq N,M\leq 2\times 10^4,1\leq a_i\leq N,1\leq d_i\leq 10^{18},2\leq k_i\leq 36,1\leq |p_i|\leq 64,1\leq x_i\leq 100,1\leq z_i\leq 10^{18}$，保证所有$a_i$互不相同，超过十进制用大写字母A~Z表示。