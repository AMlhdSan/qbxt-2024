# #4. NOIP2024 充满了希望

## 题目背景

小 G 很喜欢数据结构，尤其是 Ynoi。

这天小 G 做了一道 Ynoi 题：[[Ynoi2012] NOIP2015 充满了希望](https://www.luogu.com.cn/problem/P5524)。他觉得这题实在是太有趣了，尤其是每次对序列进行一系列 2 操作的区间推平。所以他对这题进行了加强。

## 题目描述

给一个长为 $n$ 的序列，有 $m$ 个操作，操作编号从 $1$ 到 $m$，每个操作为：

给定 $l,r$，将序列区间 $[l,r]$ 内所有元素修改为 $x$，$x$ 为区间 $[l,r]$ 内当前的最大值。

现在有 $q$ 次事件，每次事件会对序列进行修改或查询：

1. 修改：给出 $x,y$，将序列位置为 $x,y$ 的两个元素交换。
2. 修改：给出 $x,v$，将序列第 $x$ 个位置上的值改为 $v$。
3. 修改：给出 $l,r,v$，将序列区间 $[l,r]$ 内所有元素对 $v$ 取模。
4. 查询：给出 $l,r,x$，**假如**对序列依次进行 $l$ 到 $r$ 的所有操作，位置 $x$ 上的值会变成多少。

## 输入格式

第一行两个整数 $n$，$m$，表示序列长度和操作的个数。
	
第二行 $n$ 个整数，第 $i$ 个整数 $v_i$ 表示序列第 $i$ 个位置上的值。

接下来 $m$ 行，每行两个整数 $l_i,r_i$，表示第 $i$ 次操作的区间。
	
接下来一行一个整数 $q$，表示事件数量。
	
接下来 $q$ 行，每行首先一个整数 $op$，表示事件的种类。如果 $op = 1$，那么接下来两个整数 $x,y$；如果 $op = 2$，那么接下来两个整数 $x,v$；如果 $op = 3$，那么接下来三个整数 $l,r,v$；如果 $op=4$，那么接下来三个整数 $l,r,x$。具体含义见题目描述。

## 输出格式

对于每个第四类事件，输出一行一个整数表示答案。

## 样例 #1

### 样例输入 #1

```
78 71
8 25 20 37 10 65 34 27 74 70 78 48 12 11 31 38 75 15 24 63 66 64 29 3 46 58 4 67 72 54 18 36 14 28 21 60 44 50 30 68 57 23 43 2 35 5 42 62 73 13 22 77 55 32 39 53 16 47 49 76 17 51 41 45 6 40 56 1 52 9 71 61 26 7 33 19 69 59
2 30
20 45
39 61
25 78
30 59
11 65
18 63
23 60
49 52
56 66
17 31
21 46
44 58
68 77
34 45
44 49
51 66
27 70
40 71
3 9
55 59
38 63
10 36
24 25
17 67
11 55
11 52
13 48
24 42
3 69
44 77
7 66
59 60
28 45
50 63
6 74
42 70
41 42
62 68
3 27
38 78
8 42
54 68
28 69
24 60
28 78
8 48
5 44
47 47
4 59
4 21
23 32
13 31
36 53
9 66
39 78
6 71
10 29
58 75
6 7
28 34
38 67
32 66
26 54
11 19
13 18
33 69
10 12
1 43
6 9
36 78
68
1 36 27
2 68 92
2 1 56
1 76 28
4 34 56 40
2 58 42
2 72 116
2 78 139
4 5 14 16
1 12 75
1 63 3
1 9 15
4 17 36 50
2 7 177
4 34 68 48
1 11 1
2 62 262
2 19 32
2 39 391
2 32 544
2 12 329
2 64 770
1 8 58
1 68 70
1 31 9
1 3 32
1 27 74
2 73 1192
2 67 1993
1 15 11
4 37 63 60
2 5 530
1 70 71
2 38 1703
1 16 8
1 47 26
2 39 3822
1 42 60
1 59 57
4 39 71 16
2 26 2423
2 31 6199
2 33 12396
2 58 15
2 58 10159
2 37 7752
2 38 19090
1 25 75
2 71 23576
2 53 34786
1 42 64
2 8 2022
4 25 30 4
1 13 71
1 53 40
2 64 38979
1 69 63
1 24 74
1 36 50
2 50 925
2 7 15806
2 58 13945
2 11 19589
2 50 41458
4 52 68 58
1 52 11
1 43 74
4 12 12 35
```

### 样例输出 #1

```
92
78
116
177
1993
3822
34786
41458
34786
```

## 提示

对于所有测试点：$n, m, q \leq 5 \times 10 ^ 5$，$1\leq l_i \leq r_i \leq n$，$x \leq n$，$l \leq r$，$op\in \{1, 2,3,4\}$，$v \leq 10 ^ 9$。
	
每个测试点的具体限制见下表：

|测试点编号| $n\leq$ | $m\leq$ | $q\leq$ | 特殊限制 |
| :----: | :----: | :----: | :----: | :----: |
| $1,2$ | $100$ | $100$ | $100$ |      |
| $3,4,5$ | $2000$ | $2000$ | $2000$ |      |
| $6,7,8,9$ | $300$ | $300$ | $5 \times 10 ^ 5$ | $op = 4$ |
| $10,11,12,13$ | $5 \times 10 ^ 5$ | $5 \times 10 ^ 5$ | $5 \times 10 ^ 5$ | $r_i < l_{i + 1}$ |
| $14,15,16,17,18$ | $10 ^ 4$ | $10 ^ 4$ | $10 ^ 4$ |      |
| $19,20$ | $5 \times 10 ^ 4$ | $5 \times 10 ^ 4$ | $5 \times 10 ^ 4$ |      |
| $21,22,23,24,25$ | $5 \times 10 ^ 5$ | $5 \times 10 ^ 5$ | $5 \times 10 ^ 5$ |      |

此外，对于所有奇数编号的测试点，不存在三操作。