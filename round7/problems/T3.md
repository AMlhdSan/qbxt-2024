# #3. 惩罚

## 题目描述

我发现你在打摆，于是把你关进了一个树形迷宫的根节点里面。

唯一的出路在根节点，但是你要出去，就必须解除所有叶子节点的封印。定义叶子节点为度数为 $1$ 的非根节点。

每个叶子节点上都有一个数，开始时是 $0$。我给每个叶子节点都设了一个密码，然而你目前并不能看到它们。

你可以改变叶子节点上的数字，方法是这样的：在某个节点的机器上输入一个整数 ，使这个节点的子树中所有叶子节点的数加上 $v$。形式化地，如果节点 $x$ 在根节点与节点 $y$ 的唯一简单路径上，那么说明节点 $x$ 在节点 $y$ 的子树中。

要操作一个机器，你需要得到机器的口令。获取口令只有一种方法，就是做一定数量的题，然后找我换取口令。知道口令之后你就可以使用机器任意多次。不同的节点的机器的口令不同，获得口令所需做的题数也可能不同。

把一个叶子节点的数调整为和这个叶子节点上的密码一致，就可以解除这个叶子的封印，但只有在同一时刻所有叶子节点的数和各自的密码均相等时，位于根节点的出口才会打开。

你当然也可以向我询问每个叶子节点上的密码。但是我一旦把任何叶子上的密码告诉你，你就再也不能向我要到任何的口令了，即使做再多的题也不行。我当然可以把密码设得刁钻一些来恶心你。

你想知道三件事情：

1. 你至少要做多少道题才能保证逃出去。
2. 在上述情况下你可能可以得到哪些机器上的口令。也就是说，对于哪些机器，存在一种做题量最少的方案，使得你需要获取这个机器上的口令。
3. 在 1. 的情况下有多少获得口令的方案可以保证能逃出去，两种方案不同当且仅当存在一台机器，在一种方案中你获取了它的口令而另一种方案中没有。答案对 $998244353$ 取模。

## 输入格式

第一行一个正整数 $n$，表示树形迷宫的节点总数。其中根节点为 $1$ 号节点。

接下来一行 $n$ 个正整数，其中第 $i$ 个数 $c_i$ 表示为了获取编号为 $i$ 的节点的机器的口令你需要做的题数。

接下来 $n - 1$ 行，每行两个正整数，表示树形迷宫一条边的两个端点。

最后一个正整数 $k$，表示你需要回答前 $k$ 个问题。

## 输出格式

第一行输出一个整数，表示第一个问题的答案。

如果 $k\ge 2$，第二行按从小到大的顺序输出若干个整数，表示第二个问题的答案中所有机器所在节点的编号。

如果 $k\ge 3$，第三行输出第三个问题的答案模 $998244353$ 的值。

## 样例 #1

### 样例输入 #1

```
5
500 100 300 200 100
1 2
2 3
2 4
1 5
3
```

### 样例输出 #1

```
400
2 4 5
1
```

## 样例 #2

### 样例输入 #2

```
3
100 100 100
1 2
1 3
3
```

### 样例输出 #2

```
200
1 2 3
3
```

## 提示

本题采用捆绑测试。

保证 $2\leq n \leq 10^6$，$1\leq c_i\leq 10^9$，$1\leq k\leq 3$。

保证输入的是一棵树。

### 子任务 1（14 pts）

$k=1$。

### 子任务 2（21 pts）

$k\leq 2$。

### 子任务 3（14 pts）

$n\leq 10$。

### 子任务 4（21 pts）

$n\leq 200$。

### 子任务 5（15 pts）

$n\leq 3000$。

### 子任务 6（15 pts）

无特殊限制。